<div class="row">
  <div class="small-12 columns text-center">
    <h1><%= @blog.title %></h1>
    <p><%= link_to @blog.url, "http://" + @blog.url %></p>
    <div class="row">
      <div class="small-9 small-centered large-centered columns text-center"><%= image_tag @blog.image_url.to_s %>
      </div>
    </div>
  </div>
<% if user_signed_in? %>
        <% if current_user.id == @blog.user_id %>
        <div class="row">
          <div class="small-9 small-centered large-centered columns">
            <div class = "left"><%= link_to "Edit", edit_blog_path(@blog) %></div>
            <div class = "right"><%= link_to "Delete", blog_path(@blog),
             method: :delete %></div>
           </div>
        </div>
      <% end %>
    <% end %>
<div class="small-9 small-centered large-centered columns text-center"><p><%= @blog.description %></p></div>
<div class="row">
  <div class="large-6 columns"><p>Rate This Blog</p>
<%= simple_form_for [@blog, @rating] do |f| %>
  <%= f.input :blog_rating, label: "Rating", collection: 1..5 %>
  <%= f.button :submit, 'Submit Rating' %>
<% end %>

<% if !@rating.blog_rating.nil? %>
  <p>Your current rating is <%= @rating.blog_rating %></p>
<% end %>
</div>
  <div class="large-6 columns">
    <p>Review This Blog</p><%= render 'blogs/review' %></div>
</div>

<p><%= link_to 'Blogs Home', blogs_path %></p>

<% @reviews.each do |review| %>
  <div class="review">
    <%= review.reviewer.email %>
    <%= review.comment %>

    <% if review.votes.where(user: current_user).blank? %>
      <% up_vote = "fa-thumbs-o-up" %>
      <% down_vote = "fa-thumbs-o-down" %>
    <% elsif review.votes.where(user: current_user).first.vote == true %>
      <% up_vote = "fa-thumbs-up" %>
      <% down_vote = "fa-thumbs-o-down" %>
    <% else review.votes.where(user: current_user).first.vote == false %>
      <% up_vote = "fa-thumbs-o-up" %>
      <% down_vote = "fa-thumbs-down" %>
    <% end %>

    <div class='forms'>
    <div class="score">
      <%= review.score %>
    </div>

    <%= simple_form_for [review, review.votes.where(user: current_user).first || review.votes.build], html: { class: "change-vote fa #{up_vote} up", "data-type" => "json" }, remote: true do |f| %>
      <%= f.hidden_field :vote, value: 1 %>
      <%= f.button :submit, 'Like', class: 'round small' %>
    <% end %>

    <%= simple_form_for [review, review.votes.where(user: current_user).first || review.votes.build], html: { class: "change-vote fa #{down_vote} down", "data-type" => "json" }, remote: true do |f| %>
      <%= f.hidden_field :vote, value: 0 %>
      <%= f.button :submit, 'Dislike', class: 'round small' %>
    <% end %>
    </div>
  </div>
<% end %>
